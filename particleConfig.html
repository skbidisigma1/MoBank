<div id="particle-config-modal" class="particle-modal-overlay">
  <div class="particle-modal">
    <div class="particle-modal-header">
      <h2 class="particle-modal-title">Particle Configuration</h2>
      <div class="header-controls">
        <button id="preset-save-btn" class="modal-btn modal-btn-secondary" title="Save Custom Preset">
          <svg viewBox="0 0 24 24" width="16" height="16">
            <path fill="currentColor" d="M17 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3M19 19H5V5H16.17L19 7.83V19M12 12C10.34 12 9 13.34 9 15S10.34 18 12 18 15 16.66 15 15 13.66 12 12 12M6 6H15V10H6V6Z"/>
          </svg>
        </button>
        <button id="particle-modal-close" class="modal-close-btn" aria-label="Close modal">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="particle-modal-body">
      
      <div class="config-section">
        <h3>Basic Settings</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Turn particle effects on or off completely">Enable Particles</span>
            <input type="checkbox" id="particles-enabled" class="config-checkbox">
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Reduces particle count and removes movement for better accessibility">Minimal Particles (Accessibility)</span>
            <input type="checkbox" id="reduced-motion" class="config-checkbox">
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Total number of particles to display on screen">Particle Count</span>
            <div class="slider-container">
              <input type="range" id="particle-count" class="config-slider" min="0" max="500" step="5">
              <span class="slider-value editable-value" id="particle-count-value">50</span>
            </div>
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>Shape & Appearance</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Shape of each particle">Shape Type</span>
            <select id="particle-shape" class="config-select">
              <option value="circle">Circle</option>
              <option value="edge">Edge</option>
              <option value="triangle">Triangle</option>
              <option value="polygon">Polygon</option>
              <option value="star">Star</option>
              <option value="image">Image</option>
            </select>
          </label>
        </div>
        <div class="config-row" id="polygon-sides-row" style="display: none;">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Number of sides for polygon-shaped particles">Polygon Sides</span>
            <div class="slider-container">
              <input type="range" id="polygon-sides" class="config-slider" min="3" max="12" step="1">
              <span class="slider-value" id="polygon-sides-value">5</span>
            </div>
          </label>
        </div>
        <div class="config-row" id="star-sides-row" style="display: none;">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Number of points for star-shaped particles">Star Points</span>
            <div class="slider-container">
              <input type="range" id="star-sides" class="config-slider" min="3" max="12" step="1">
              <span class="slider-value" id="star-sides-value">5</span>
            </div>
          </label>
        </div>
        <div class="config-row" id="image-source-row" style="display: none;">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="URL to an image file to use as particle shape">Image URL</span>
            <input type="text" id="image-source" class="config-input" placeholder="Enter image URL">
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>Color Settings</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Choose between single color, multiple colors, or random colors for particles">Color Mode</span>
            <select id="color-mode" class="config-select">
              <option value="single">Single Color</option>
              <option value="multiple">Multiple Colors</option>
              <option value="random">Random Colors</option>
            </select>
          </label>
        </div>
        <div class="config-row" id="single-color-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Color to use for particles">Particle Color</span>
            <input type="color" id="particle-color" class="config-color">
          </label>
        </div>
        <div class="config-section" id="multiple-colors-section" style="display: none;">
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="List of colors that particles can randomly use">Colors</span>
              <button id="add-color-btn" class="modal-btn modal-btn-secondary">Add Color</button>
            </label>
          </div>
          <div id="color-list" class="color-list"></div>
        </div>
      </div>

      <div class="config-section">
        <h3>Size & Opacity</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Base size of particles in pixels">Size</span>
            <div class="slider-container">
              <input type="range" id="particle-size" class="config-slider" min="0.5" max="50" step="0.1">
              <span class="slider-value editable-value" id="particle-size-value">3px</span>
            </div>
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Enable random size variation for particles">Random Size</span>
            <input type="checkbox" id="size-random" class="config-checkbox">
          </label>
        </div>
        <div class="config-group" id="size-random-controls" style="display: none;">
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="How much size can vary from the base size">Size Variation</span>
              <div class="slider-container">
                <input type="range" id="size-variation" class="config-slider" min="0" max="1" step="0.01">
                <span class="slider-value editable-value" id="size-variation-value">50%</span>
              </div>
            </label>
          </div>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Transparency level of particles (0% = near invisible, 100% = fully opaque)">Opacity</span>
            <div class="slider-container">
              <input type="range" id="particle-opacity" class="config-slider" min="0" max="1" step="0.01">
              <span class="slider-value editable-value" id="particle-opacity-value">50%</span>
            </div>
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Enable random opacity variation for particles">Random Opacity</span>
            <input type="checkbox" id="opacity-random" class="config-checkbox">
          </label>
        </div>
        <div class="config-group" id="opacity-random-controls" style="display: none;">
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="How much opacity can vary from the base opacity">Opacity Variation</span>
              <div class="slider-container">
                <input type="range" id="opacity-variation" class="config-slider" min="0" max="1" step="0.01">
                <span class="slider-value editable-value" id="opacity-variation-value">50%</span>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="config-section">
        <h3>Movement</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Allow particles to move around the screen">Enable Movement</span>
            <input type="checkbox" id="move-enable" class="config-checkbox">
          </label>
        </div>
        <div class="config-group" id="movement-controls">
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="How fast particles move">Speed</span>
              <div class="slider-container">
                <input type="range" id="move-speed" class="config-slider" min="0" max="10" step="0.1">
                <span class="slider-value" id="move-speed-value">1</span>
              </div>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Pattern of particle movement">Movement Type</span>
              <select id="move-type" class="config-select">
                <option value="default">Default (Brownian)</option>
                <option value="random">Random Direction</option>
                <option value="straight">Straight Direction</option>
              </select>
            </label>
          </div>
          <div class="config-row" id="direction-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Direction particles move">Direction</span>
              <select id="move-direction" class="config-select">
                <option value="none">None (Random)</option>
                <option value="top">Top</option>
                <option value="top-right">Top Right</option>
                <option value="right">Right</option>
                <option value="bottom-right">Bottom Right</option>
                <option value="bottom">Bottom</option>
                <option value="bottom-left">Bottom Left</option>
                <option value="left">Left</option>
                <option value="top-left">Top Left</option>
              </select>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="What happens when particles reach screen edges: Out (disappear), Bounce (reverse direction), or Destroy (remove permanently)">Out Mode</span>
              <select id="move-out-mode" class="config-select">
                <option value="out">Out</option>
                <option value="bounce">Bounce</option>
                <option value="destroy">Destroy</option>
              </select>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Particles attract other particles toward them">Attract Particles</span>
              <input type="checkbox" id="move-attract" class="config-checkbox">
            </label>
          </div>
          <div class="config-group" id="attract-controls" style="display: none;">
            <div class="config-row">
              <label class="config-label">
                <span class="config-tooltip" data-tooltip="Rotation force on X-axis for particle attraction">Rotate X</span>
                <div class="slider-container">
                  <input type="range" id="attract-rotate-x" class="config-slider" min="0" max="3000" step="50">
                  <span class="slider-value" id="attract-rotate-x-value">600</span>
                </div>
              </label>
            </div>
            <div class="config-row">
              <label class="config-label">
                <span class="config-tooltip" data-tooltip="Rotation force on Y-axis for particle attraction">Rotate Y</span>
                <div class="slider-container">
                  <input type="range" id="attract-rotate-y" class="config-slider" min="0" max="3000" step="50">
                  <span class="slider-value" id="attract-rotate-y-value">1200</span>
                </div>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="config-section">
        <h3>Line Connections</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Draw connecting lines between nearby particles">Enable Lines</span>
            <input type="checkbox" id="line-linked-enable" class="config-checkbox">
          </label>
        </div>
        <div class="config-group" id="line-controls">
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Maximum distance between particles to draw a connecting line">Line Distance</span>
              <div class="slider-container">
                <input type="range" id="line-linked-distance" class="config-slider" min="0" max="500" step="10">
                <span class="slider-value" id="line-linked-distance-value">150px</span>
              </div>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Color of the connecting lines between particles">Line Color</span>
              <input type="color" id="line-linked-color" class="config-color">
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Transparency of the connecting lines">Line Opacity</span>
              <div class="slider-container">
                <input type="range" id="line-linked-opacity" class="config-slider" min="0" max="1" step="0.01">
                <span class="slider-value" id="line-linked-opacity-value">40%</span>
              </div>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Thickness of the connecting lines in pixels">Line Width</span>
              <div class="slider-container">
                <input type="range" id="line-linked-width" class="config-slider" min="0.1" max="10" step="0.1">
                <span class="slider-value" id="line-linked-width-value">1px</span>
              </div>
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Fill triangular areas created by connecting lines between 3 particles">Triangles</span>
              <input type="checkbox" id="line-triangles" class="config-checkbox">
            </label>
          </div>
          <div class="config-row">
            <label class="config-label">
              <span class="config-tooltip" data-tooltip="Apply subtle warping effect to connecting lines">Line Warp</span>
              <input type="checkbox" id="line-warp" class="config-checkbox">
            </label>
          </div>
          <div class="config-group" id="triangle-controls" style="display: none;">
            <div class="config-row">
              <label class="config-label">
                <span class="config-tooltip" data-tooltip="Fill color for triangular areas created by connecting lines">Triangle Color</span>
                <input type="color" id="triangle-color" class="config-color">
              </label>
            </div>
            <div class="config-row">
              <label class="config-label">
                <span class="config-tooltip" data-tooltip="Transparency of the triangular fill areas">Triangle Opacity</span>
                <div class="slider-container">
                  <input type="range" id="triangle-opacity" class="config-slider" min="0" max="1" step="0.01">
                  <span class="slider-value editable-value" id="triangle-opacity-value">50%</span>
                </div>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="config-section">
        <h3>Interactivity</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Area where mouse/touch interactions are detected: Canvas (particle area only) or Window (entire page)">Detect On</span>
            <select id="detect-on" class="config-select">
              <option value="canvas">Canvas</option>
              <option value="window">Window</option>
            </select>
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Action when clicking/tapping the page">Click Effect</span>
            <select id="click-mode" class="config-select">
              <option value="none">None</option>
              <option value="push">Spawn</option>
              <option value="remove">Remove</option>
            </select>
          </label>
        </div>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Automatically adjust particles when window size changes">Resize Detection</span>
            <input type="checkbox" id="resize-enable" class="config-checkbox">
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>Click Effect Settings</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Number of particles to spawn or remove when clicking">Particles Number</span>
            <div class="slider-container">
              <input type="range" id="push-particles-nb" class="config-slider" min="1" max="10" step="1">
              <span class="slider-value" id="push-particles-nb-value">4</span>
            </div>
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>Advanced Settings</h3>
        <div class="config-row">
          <label class="config-label">
            <span class="config-tooltip" data-tooltip="Automatically adjust particle quality and density for high-resolution displays">Retina Detection</span>
            <input type="checkbox" id="retina-detect" class="config-checkbox">
          </label>
        </div>
      </div>

      <div class="config-section">
        <h3>Built-in Presets</h3>
        <div class="config-row preset-buttons">
          <button class="preset-btn" data-preset="minimal">Minimal</button>
          <button class="preset-btn" data-preset="snow">Snow</button>
          <button class="preset-btn" data-preset="stars">Stars</button>
          <button class="preset-btn" data-preset="bubbles">Bubbles</button>
          <button class="preset-btn" data-preset="neon">Neon</button>
          <button class="preset-btn" data-preset="rainbow">Rainbow</button>
        </div>
        
        <h3>Custom Presets</h3>
        <div id="custom-presets" class="custom-presets">
          <p class="no-custom-presets" style="display: none; color: #666; font-style: italic;">No custom presets saved yet.</p>
        </div>
        <div class="config-row">
          <button id="reset-defaults" class="modal-btn modal-btn-secondary">Reset to Defaults</button>
          <button id="import-config-btn" class="modal-btn modal-btn-secondary">Import Config</button>
          <button id="export-config-btn" class="modal-btn modal-btn-secondary">Export Config</button>
          <input type="file" id="config-file-input" accept=".json" style="display: none;">
        </div>
      </div>

    </div>
    <div class="particle-modal-footer">
      <span class="auto-save-indicator">Settings automatically saved</span>
      <button id="particle-modal-close-footer" class="modal-btn modal-btn-primary">Close</button>
    </div>
  </div>
</div>

